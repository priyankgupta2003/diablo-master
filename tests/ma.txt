ccount : 0ccount : 0ccount : 0ccount : 0ccount : 0ccount : 0ccount : 0ccount : 0ccount : 0Imperative program:
BlockS(List(VarDeclS(M,
                     None(),
                     Some(Call(rdd_block_tensor_2_0,
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()),
                                    Comprehension(Tuple(List(Tuple(List(Var(i),
                                                                        Var(j))),
                                                             MethodCall(MethodCall(Var(i),
                                                                                   *,
                                                                                   List(IntConst(100))),
                                                                        +,
                                                                        List(Var(j))))),
                                                  List(Generator(VarPat(i),
                                                                 Range(IntConst(0),
                                                                       IntConst(99),
                                                                       IntConst(1))),
                                                       Generator(VarPat(j),
                                                                 Range(IntConst(0),
                                                                       IntConst(99),
                                                                       IntConst(1))))))))),
            VarDeclS(N,
                     None(),
                     Some(Call(rdd_block_tensor_2_0,
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()),
                                    Comprehension(Tuple(List(Tuple(List(Var(i),
                                                                        Var(j))),
                                                             MethodCall(MethodCall(Var(i),
                                                                                   *,
                                                                                   List(IntConst(100))),
                                                                        +,
                                                                        List(Var(j))))),
                                                  List(Generator(VarPat(i),
                                                                 Range(IntConst(0),
                                                                       IntConst(99),
                                                                       IntConst(1))),
                                                       Generator(VarPat(j),
                                                                 Range(IntConst(0),
                                                                       IntConst(99),
                                                                       IntConst(1))))))))),
            VarDeclS(res,
                     None(),
                     Some(Call(rdd_block_tensor_2_0,
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()),
                                    Comprehension(Tuple(List(Tuple(List(Var(i),
                                                                        Var(j))),
                                                             MethodCall(Var(a),
                                                                        +,
                                                                        List(Var(b))))),
                                                  List(Generator(TuplePat(List(TuplePat(List(VarPat(i),
                                                                                             VarPat(j))),
                                                                               VarPat(a))),
                                                                 Var(M)),
                                                       Generator(TuplePat(List(TuplePat(List(VarPat(ii),
                                                                                             VarPat(jj))),
                                                                               VarPat(b))),
                                                                 Var(N)),
                                                       Predicate(MethodCall(Var(ii),
                                                                            ==,
                                                                            List(Var(i)))),
                                                       Predicate(MethodCall(Var(jj),
                                                                            ==,
                                                                            List(Var(j)))))))))),
            ExprS(Var(res))))
Loading rdd_block_tensor_2_0:
       typemap rdd_block_tensor_2_0[T] ( d: (Int,Int), s: () ): array2[T] {
          def view ( x: rdd[((Int,Int),tensor_2_0[T])] )
            = [ ((ii1 * 10 + i1,ii2 * 10 + i2),v) |
                ((ii1,ii2),a) <- lift(rdd,x),
                ((i1,i2),v) <- lift(tensor_2_0,a),
                ii1 * 10 + i1 >= 0, ii1 * 10 + i1 < d#1, ii2 * 10 + i2 >= 0, ii2 * 10 + i2 < d#2 ]
          def store ( L: list[((Int,Int),T)] )
            = rdd[ ((ii1,ii2),tensor_2_0((if ((ii1+1)*10 > d#1) (d#1 % 10) else 10,if ((ii2+1)*10 > d#2) (d#2 % 10) else 10),(),w)) |
                   ((i1,i2),v) <- L,
                   let ii1 = i1 / 10,let ii2 = i2 / 10,
                   let w = ((i1 % 10,i2 % 10),v),
                   group by (ii1,ii2) ]
    }
    
Loading tensor_2_0:
       typemap tensor_2_0[T] ( d: (Int,Int), s: () ): array2[T] {
          def view ( values: vector[T] )
            = [ ((i1,i2),values[(i1*d#2+i2)]) |
                i1 <- 0..(d#1-1), i2 <- 0..(d#2-1) ]
          def store ( L: list[((Int,Int),T)] )
            = { var zero: T;
                var buffer: vector[T] = array_buffer_dense(d#1*d#2,zero);
                [ { buffer[(i1*d#2+i2)] = v } |
                  ((i1,i2),v) <- L, i1 >= 0, i1 < d#1, i2 >= 0, i2 < d#2 ];
                buffer }
       }
      
ccount : 0ccount : 0Normalized comprehension:
Block(List(VarDecl(M,
                   ArrayType(2, BasicType(Int)),
                   Seq(List(Call(rdd_block_tensor_2_0,
                                 List(Tuple(List(IntConst(100), IntConst(100))),
                                      Tuple(List()),
                                      Comprehension(Tuple(List(Tuple(List(Var(i),
                                                                          Var(j))),
                                                               MethodCall(MethodCall(Var(i),
                                                                                     *,
                                                                                     List(IntConst(100))),
                                                                          +,
                                                                          List(Var(j))))),
                                                    List(Generator(VarPat(i),
                                                                   Range(IntConst(0),
                                                                         IntConst(99),
                                                                         IntConst(1))),
                                                         Generator(VarPat(j),
                                                                   Range(IntConst(0),
                                                                         IntConst(99),
                                                                         IntConst(1)))))))))),
           VarDecl(N,
                   ArrayType(2, BasicType(Int)),
                   Seq(List(Call(rdd_block_tensor_2_0,
                                 List(Tuple(List(IntConst(100), IntConst(100))),
                                      Tuple(List()),
                                      Comprehension(Tuple(List(Tuple(List(Var(i),
                                                                          Var(j))),
                                                               MethodCall(MethodCall(Var(i),
                                                                                     *,
                                                                                     List(IntConst(100))),
                                                                          +,
                                                                          List(Var(j))))),
                                                    List(Generator(VarPat(i),
                                                                   Range(IntConst(0),
                                                                         IntConst(99),
                                                                         IntConst(1))),
                                                         Generator(VarPat(j),
                                                                   Range(IntConst(0),
                                                                         IntConst(99),
                                                                         IntConst(1)))))))))),
           VarDecl(res,
                   ArrayType(2, BasicType(Int)),
                   Seq(List(Call(rdd_block_tensor_2_0,
                                 List(Tuple(List(IntConst(100), IntConst(100))),
                                      Tuple(List()),
                                      Comprehension(Tuple(List(Tuple(List(Var(i),
                                                                          Var(j))),
                                                               MethodCall(Var(a),
                                                                          +,
                                                                          List(Var(b))))),
                                                    List(Generator(TuplePat(List(TuplePat(List(VarPat(i),
                                                                                               VarPat(j))),
                                                                                 VarPat(a))),
                                                                   Var(M)),
                                                         Generator(TuplePat(List(TuplePat(List(VarPat(ii),
                                                                                               VarPat(jj))),
                                                                                 VarPat(b))),
                                                                   Var(N)),
                                                         Predicate(MethodCall(Var(ii),
                                                                              ==,
                                                                              List(Var(i)))),
                                                         Predicate(MethodCall(Var(jj),
                                                                              ==,
                                                                              List(Var(j))))))))))),
           Seq(List(Var(res)))))
Lifted comprehension:
Block(List(VarDecl(M,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Store(rdd_block_tensor_2_0,
                                  List(BasicType(Int)),
                                  List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List())),
                                  Comprehension(Tuple(List(Tuple(List(Var(i),
                                                                      Var(j))),
                                                           MethodCall(MethodCall(Var(i),
                                                                                 *,
                                                                                 List(IntConst(100))),
                                                                      +,
                                                                      List(Var(j))))),
                                                List(Generator(VarPat(i),
                                                               Range(IntConst(0),
                                                                     IntConst(99),
                                                                     IntConst(1))),
                                                     Generator(VarPat(j),
                                                               Range(IntConst(0),
                                                                     IntConst(99),
                                                                     IntConst(1))))))))),
           VarDecl(N,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Store(rdd_block_tensor_2_0,
                                  List(BasicType(Int)),
                                  List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List())),
                                  Comprehension(Tuple(List(Tuple(List(Var(i),
                                                                      Var(j))),
                                                           MethodCall(MethodCall(Var(i),
                                                                                 *,
                                                                                 List(IntConst(100))),
                                                                      +,
                                                                      List(Var(j))))),
                                                List(Generator(VarPat(i),
                                                               Range(IntConst(0),
                                                                     IntConst(99),
                                                                     IntConst(1))),
                                                     Generator(VarPat(j),
                                                               Range(IntConst(0),
                                                                     IntConst(99),
                                                                     IntConst(1))))))))),
           VarDecl(res,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Store(rdd_block_tensor_2_0,
                                  List(BasicType(Int)),
                                  List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List())),
                                  Comprehension(Tuple(List(Tuple(List(Var(i),
                                                                      Var(j))),
                                                           MethodCall(Var(a),
                                                                      +,
                                                                      List(Var(b))))),
                                                List(Generator(TuplePat(List(TuplePat(List(VarPat(i),
                                                                                           VarPat(j))),
                                                                             VarPat(a))),
                                                               Lift(rdd_block_tensor_2_0,
                                                                    Var(M))),
                                                     Generator(TuplePat(List(TuplePat(List(VarPat(ii),
                                                                                           VarPat(jj))),
                                                                             VarPat(b))),
                                                               Lift(rdd_block_tensor_2_0,
                                                                    Var(N))),
                                                     Predicate(MethodCall(Var(ii),
                                                                          ==,
                                                                          List(Var(i)))),
                                                     Predicate(MethodCall(Var(jj),
                                                                          ==,
                                                                          List(Var(j)))))))))),
           Seq(List(Var(res)))))
Parallelizing the in-memory comprehension:
Comprehension(Tuple(List(Var(_coord_i),
                         Var(_coord_j),
                         Var(_size_i),
                         Var(_size_j))),
              List(Generator(VarPat(_coord_i),
                             Range(MethodCall(IntConst(0),
                                              /,
                                              List(IntConst(10))),
                                   MethodCall(IntConst(99),
                                              /,
                                              List(IntConst(10))),
                                   IntConst(1))),
                   Generator(VarPat(_coord_j),
                             Range(MethodCall(IntConst(0),
                                              /,
                                              List(IntConst(10))),
                                   MethodCall(IntConst(99),
                                              /,
                                              List(IntConst(10))),
                                   IntConst(1))),
                   LetBinding(VarPat(_size_i),
                              IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                   +,
                                                                   List(IntConst(1))),
                                                        *,
                                                        List(IntConst(10))),
                                             >,
                                             List(IntConst(100))),
                                  MethodCall(IntConst(100),
                                             %,
                                             List(IntConst(10))),
                                  IntConst(10))),
                   LetBinding(VarPat(_size_j),
                              IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                   +,
                                                                   List(IntConst(1))),
                                                        *,
                                                        List(IntConst(10))),
                                             >,
                                             List(IntConst(100))),
                                  MethodCall(IntConst(100),
                                             %,
                                             List(IntConst(10))),
                                  IntConst(10)))))
Parallelizing the in-memory comprehension:
Comprehension(Tuple(List(Var(_coord_i),
                         Var(_coord_j),
                         Var(_size_i),
                         Var(_size_j))),
              List(Generator(VarPat(_coord_i),
                             Range(MethodCall(IntConst(0),
                                              /,
                                              List(IntConst(10))),
                                   MethodCall(IntConst(99),
                                              /,
                                              List(IntConst(10))),
                                   IntConst(1))),
                   Generator(VarPat(_coord_j),
                             Range(MethodCall(IntConst(0),
                                              /,
                                              List(IntConst(10))),
                                   MethodCall(IntConst(99),
                                              /,
                                              List(IntConst(10))),
                                   IntConst(1))),
                   LetBinding(VarPat(_size_i),
                              IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                   +,
                                                                   List(IntConst(1))),
                                                        *,
                                                        List(IntConst(10))),
                                             >,
                                             List(IntConst(100))),
                                  MethodCall(IntConst(100),
                                             %,
                                             List(IntConst(10))),
                                  IntConst(10))),
                   LetBinding(VarPat(_size_j),
                              IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                   +,
                                                                   List(IntConst(1))),
                                                        *,
                                                        List(IntConst(10))),
                                             >,
                                             List(IntConst(100))),
                                  MethodCall(IntConst(100),
                                             %,
                                             List(IntConst(10))),
                                  IntConst(10)))))
Comprehension that preserves tilling:
Comprehension(Tuple(List(Tuple(List(Var(_coord_i), Var(_coord_j))),
                         Store(tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                    +,
                                                                                    List(IntConst(1))),
                                                                         *,
                                                                         List(IntConst(10))),
                                                              >,
                                                              List(IntConst(100))),
                                                   MethodCall(IntConst(100),
                                                              %,
                                                              List(IntConst(10))),
                                                   IntConst(10)),
                                               IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                    +,
                                                                                    List(IntConst(1))),
                                                                         *,
                                                                         List(IntConst(10))),
                                                              >,
                                                              List(IntConst(100))),
                                                   MethodCall(IntConst(100),
                                                              %,
                                                              List(IntConst(10))),
                                                   IntConst(10)))),
                                    Tuple(List())),
                               Comprehension(Tuple(List(Tuple(List(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                    *,
                                                                                                    List(IntConst(10))),
                                                                                         +,
                                                                                         List(Var(_tile_i))),
                                                                              %,
                                                                              List(IntConst(10))),
                                                                   MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                    *,
                                                                                                    List(IntConst(10))),
                                                                                         +,
                                                                                         List(Var(_tile_j))),
                                                                              %,
                                                                              List(IntConst(10))))),
                                                        MethodCall(Var(a),
                                                                   +,
                                                                   List(Var(b))))),
                                             List(Generator(TuplePat(List(TuplePat(List(VarPat(_tile_i),
                                                                                        VarPat(_tile_j))),
                                                                          VarPat(a))),
                                                            Lift(tensor_2_0,
                                                                 Var(_tile_a))),
                                                  Generator(TuplePat(List(TuplePat(List(VarPat(_tile_ii),
                                                                                        VarPat(_tile_jj))),
                                                                          VarPat(b))),
                                                            Lift(tensor_2_0,
                                                                 Var(_tile_b))),
                                                  Predicate(MethodCall(MethodCall(MethodCall(Var(_coord_ii),
                                                                                             *,
                                                                                             List(IntConst(10))),
                                                                                  +,
                                                                                  List(Var(_tile_ii))),
                                                                       ==,
                                                                       List(MethodCall(MethodCall(Var(_coord_i),
                                                                                                  *,
                                                                                                  List(IntConst(10))),
                                                                                       +,
                                                                                       List(Var(_tile_i)))))),
                                                  Predicate(MethodCall(MethodCall(MethodCall(Var(_coord_jj),
                                                                                             *,
                                                                                             List(IntConst(10))),
                                                                                  +,
                                                                                  List(Var(_tile_jj))),
                                                                       ==,
                                                                       List(MethodCall(MethodCall(Var(_coord_j),
                                                                                                  *,
                                                                                                  List(IntConst(10))),
                                                                                       +,
                                                                                       List(Var(_tile_j))))))))))),
              List(Generator(TuplePat(List(TuplePat(List(VarPat(_coord_i),
                                                         VarPat(_coord_j))),
                                           VarPat(_tile_a))),
                             Lift(rdd, Nth(Var(M), 3))),
                   Generator(TuplePat(List(TuplePat(List(VarPat(_coord_ii),
                                                         VarPat(_coord_jj))),
                                           VarPat(_tile_b))),
                             Lift(rdd, Nth(Var(N), 3))),
                   Predicate(MethodCall(Var(_coord_ii),
                                        ==,
                                        List(Var(_coord_i)))),
                   Predicate(MethodCall(Var(_coord_jj),
                                        ==,
                                        List(Var(_coord_j))))))
Translated tiled comprehension:
Block(List(VarDecl(M,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Tuple(List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List()),
                                       flatMap(Lambda(TuplePat(List(VarPat(_coord_i),
                                                                    VarPat(_coord_j),
                                                                    VarPat(_size_i),
                                                                    VarPat(_size_j))),
                                                      Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                     Var(_coord_j))),
                                                                          Store(tensor_2_0,
                                                                                List(BasicType(Int)),
                                                                                List(Tuple(List(Var(_size_i),
                                                                                                Var(_size_j))),
                                                                                     Tuple(List())),
                                                                                Comprehension(Tuple(List(Tuple(List(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_i))),
                                                                                                                               %,
                                                                                                                               List(IntConst(10))),
                                                                                                                    MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_j))),
                                                                                                                               %,
                                                                                                                               List(IntConst(10))))),
                                                                                                         MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_i))),
                                                                                                                               *,
                                                                                                                               List(IntConst(100))),
                                                                                                                    +,
                                                                                                                    List(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                               *,
                                                                                                                                               List(IntConst(10))),
                                                                                                                                    +,
                                                                                                                                    List(Var(_tile_j))))))),
                                                                                              List(Generator(VarPat(_tile_i),
                                                                                                             Range(IntConst(0),
                                                                                                                   MethodCall(Var(_size_i),
                                                                                                                              -,
                                                                                                                              List(IntConst(1))),
                                                                                                                   IntConst(1))),
                                                                                                   Generator(VarPat(_tile_j),
                                                                                                             Range(IntConst(0),
                                                                                                                   MethodCall(Var(_size_j),
                                                                                                                              -,
                                                                                                                              List(IntConst(1))),
                                                                                                                   IntConst(1))))))))))),
                                               MethodCall(Var(spark_context),
                                                          parallelize,
                                                          List(Comprehension(Tuple(List(Var(_coord_i),
                                                                                        Var(_coord_j),
                                                                                        IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                             +,
                                                                                                                             List(IntConst(1))),
                                                                                                                  *,
                                                                                                                  List(IntConst(10))),
                                                                                                       >,
                                                                                                       List(IntConst(100))),
                                                                                            MethodCall(IntConst(100),
                                                                                                       %,
                                                                                                       List(IntConst(10))),
                                                                                            IntConst(10)),
                                                                                        IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                             +,
                                                                                                                             List(IntConst(1))),
                                                                                                                  *,
                                                                                                                  List(IntConst(10))),
                                                                                                       >,
                                                                                                       List(IntConst(100))),
                                                                                            MethodCall(IntConst(100),
                                                                                                       %,
                                                                                                       List(IntConst(10))),
                                                                                            IntConst(10)))),
                                                                             List(Generator(VarPat(_coord_i),
                                                                                            Range(IntConst(0),
                                                                                                  MethodCall(IntConst(99),
                                                                                                             /,
                                                                                                             List(IntConst(10))),
                                                                                                  IntConst(1))),
                                                                                  Generator(VarPat(_coord_j),
                                                                                            Range(IntConst(0),
                                                                                                  MethodCall(IntConst(99),
                                                                                                             /,
                                                                                                             List(IntConst(10))),
                                                                                                  IntConst(1))))),
                                                               IntConst(10))))))))),
           VarDecl(N,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Tuple(List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List()),
                                       flatMap(Lambda(TuplePat(List(VarPat(_coord_i),
                                                                    VarPat(_coord_j),
                                                                    VarPat(_size_i),
                                                                    VarPat(_size_j))),
                                                      Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                     Var(_coord_j))),
                                                                          Store(tensor_2_0,
                                                                                List(BasicType(Int)),
                                                                                List(Tuple(List(Var(_size_i),
                                                                                                Var(_size_j))),
                                                                                     Tuple(List())),
                                                                                Comprehension(Tuple(List(Tuple(List(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_i))),
                                                                                                                               %,
                                                                                                                               List(IntConst(10))),
                                                                                                                    MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_j))),
                                                                                                                               %,
                                                                                                                               List(IntConst(10))))),
                                                                                                         MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_i))),
                                                                                                                               *,
                                                                                                                               List(IntConst(100))),
                                                                                                                    +,
                                                                                                                    List(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                               *,
                                                                                                                                               List(IntConst(10))),
                                                                                                                                    +,
                                                                                                                                    List(Var(_tile_j))))))),
                                                                                              List(Generator(VarPat(_tile_i),
                                                                                                             Range(IntConst(0),
                                                                                                                   MethodCall(Var(_size_i),
                                                                                                                              -,
                                                                                                                              List(IntConst(1))),
                                                                                                                   IntConst(1))),
                                                                                                   Generator(VarPat(_tile_j),
                                                                                                             Range(IntConst(0),
                                                                                                                   MethodCall(Var(_size_j),
                                                                                                                              -,
                                                                                                                              List(IntConst(1))),
                                                                                                                   IntConst(1))))))))))),
                                               MethodCall(Var(spark_context),
                                                          parallelize,
                                                          List(Comprehension(Tuple(List(Var(_coord_i),
                                                                                        Var(_coord_j),
                                                                                        IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                             +,
                                                                                                                             List(IntConst(1))),
                                                                                                                  *,
                                                                                                                  List(IntConst(10))),
                                                                                                       >,
                                                                                                       List(IntConst(100))),
                                                                                            MethodCall(IntConst(100),
                                                                                                       %,
                                                                                                       List(IntConst(10))),
                                                                                            IntConst(10)),
                                                                                        IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                             +,
                                                                                                                             List(IntConst(1))),
                                                                                                                  *,
                                                                                                                  List(IntConst(10))),
                                                                                                       >,
                                                                                                       List(IntConst(100))),
                                                                                            MethodCall(IntConst(100),
                                                                                                       %,
                                                                                                       List(IntConst(10))),
                                                                                            IntConst(10)))),
                                                                             List(Generator(VarPat(_coord_i),
                                                                                            Range(IntConst(0),
                                                                                                  MethodCall(IntConst(99),
                                                                                                             /,
                                                                                                             List(IntConst(10))),
                                                                                                  IntConst(1))),
                                                                                  Generator(VarPat(_coord_j),
                                                                                            Range(IntConst(0),
                                                                                                  MethodCall(IntConst(99),
                                                                                                             /,
                                                                                                             List(IntConst(10))),
                                                                                                  IntConst(1))))),
                                                               IntConst(10))))))))),
           VarDecl(res,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Tuple(List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List()),
                                       Store(rdd,
                                             List(TupleType(List(TupleType(List(BasicType(Int),
                                                                                BasicType(Int))),
                                                                 StorageType(tensor_2_0,
                                                                             List(BasicType(Int)),
                                                                             List(Tuple(List(IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                  +,
                                                                                                                                  List(IntConst(1))),
                                                                                                                       *,
                                                                                                                       List(IntConst(10))),
                                                                                                            >,
                                                                                                            List(IntConst(100))),
                                                                                                 MethodCall(IntConst(100),
                                                                                                            %,
                                                                                                            List(IntConst(10))),
                                                                                                 IntConst(10)),
                                                                                             IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                  +,
                                                                                                                                  List(IntConst(1))),
                                                                                                                       *,
                                                                                                                       List(IntConst(10))),
                                                                                                            >,
                                                                                                            List(IntConst(100))),
                                                                                                 MethodCall(IntConst(100),
                                                                                                            %,
                                                                                                            List(IntConst(10))),
                                                                                                 IntConst(10)))),
                                                                                  Tuple(List())))))),
                                             List(),
                                             Comprehension(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                 Var(_coord_j))),
                                                                      Store(tensor_2_0,
                                                                            List(BasicType(Int)),
                                                                            List(Tuple(List(IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                 +,
                                                                                                                                 List(IntConst(1))),
                                                                                                                      *,
                                                                                                                      List(IntConst(10))),
                                                                                                           >,
                                                                                                           List(IntConst(100))),
                                                                                                MethodCall(IntConst(100),
                                                                                                           %,
                                                                                                           List(IntConst(10))),
                                                                                                IntConst(10)),
                                                                                            IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                 +,
                                                                                                                                 List(IntConst(1))),
                                                                                                                      *,
                                                                                                                      List(IntConst(10))),
                                                                                                           >,
                                                                                                           List(IntConst(100))),
                                                                                                MethodCall(IntConst(100),
                                                                                                           %,
                                                                                                           List(IntConst(10))),
                                                                                                IntConst(10)))),
                                                                                 Tuple(List())),
                                                                            Comprehension(Tuple(List(Tuple(List(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                 *,
                                                                                                                                                 List(IntConst(10))),
                                                                                                                                      +,
                                                                                                                                      List(Var(_tile_i))),
                                                                                                                           %,
                                                                                                                           List(IntConst(10))),
                                                                                                                MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                 *,
                                                                                                                                                 List(IntConst(10))),
                                                                                                                                      +,
                                                                                                                                      List(Var(_tile_j))),
                                                                                                                           %,
                                                                                                                           List(IntConst(10))))),
                                                                                                     MethodCall(Var(a),
                                                                                                                +,
                                                                                                                List(Var(b))))),
                                                                                          List(Generator(TuplePat(List(TuplePat(List(VarPat(_tile_i),
                                                                                                                                     VarPat(_tile_j))),
                                                                                                                       VarPat(a))),
                                                                                                         Lift(tensor_2_0,
                                                                                                              Var(_tile_a))),
                                                                                               Generator(TuplePat(List(TuplePat(List(VarPat(_tile_ii),
                                                                                                                                     VarPat(_tile_jj))),
                                                                                                                       VarPat(b))),
                                                                                                         Lift(tensor_2_0,
                                                                                                              Var(_tile_b))),
                                                                                               Predicate(MethodCall(MethodCall(MethodCall(Var(_coord_ii),
                                                                                                                                          *,
                                                                                                                                          List(IntConst(10))),
                                                                                                                               +,
                                                                                                                               List(Var(_tile_ii))),
                                                                                                                    ==,
                                                                                                                    List(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                               *,
                                                                                                                                               List(IntConst(10))),
                                                                                                                                    +,
                                                                                                                                    List(Var(_tile_i)))))),
                                                                                               Predicate(MethodCall(MethodCall(MethodCall(Var(_coord_jj),
                                                                                                                                          *,
                                                                                                                                          List(IntConst(10))),
                                                                                                                               +,
                                                                                                                               List(Var(_tile_jj))),
                                                                                                                    ==,
                                                                                                                    List(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                               *,
                                                                                                                                               List(IntConst(10))),
                                                                                                                                    +,
                                                                                                                                    List(Var(_tile_j))))))))))),
                                                           List(Generator(TuplePat(List(TuplePat(List(VarPat(_coord_i),
                                                                                                      VarPat(_coord_j))),
                                                                                        VarPat(_tile_a))),
                                                                          Lift(rdd,
                                                                               Nth(Var(M),
                                                                                   3))),
                                                                Generator(TuplePat(List(TuplePat(List(VarPat(_coord_ii),
                                                                                                      VarPat(_coord_jj))),
                                                                                        VarPat(_tile_b))),
                                                                          Lift(rdd,
                                                                               Nth(Var(N),
                                                                                   3))),
                                                                Predicate(MethodCall(Var(_coord_ii),
                                                                                     ==,
                                                                                     List(Var(_coord_i)))),
                                                                Predicate(MethodCall(Var(_coord_jj),
                                                                                     ==,
                                                                                     List(Var(_coord_j)))))))))))),
           Seq(List(Var(res)))))
Translated RDD comprehension:
Block(List(VarDecl(M,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Tuple(List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List()),
                                       flatMap(Lambda(TuplePat(List(VarPat(_coord_i),
                                                                    VarPat(_coord_j),
                                                                    VarPat(_size_i),
                                                                    VarPat(_size_j))),
                                                      Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                     Var(_coord_j))),
                                                                          Store(tensor_2_0,
                                                                                List(BasicType(Int)),
                                                                                List(Tuple(List(Var(_size_i),
                                                                                                Var(_size_j))),
                                                                                     Tuple(List())),
                                                                                Comprehension(Tuple(List(Tuple(List(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_i))),
                                                                                                                               %,
                                                                                                                               List(IntConst(10))),
                                                                                                                    MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_j))),
                                                                                                                               %,
                                                                                                                               List(IntConst(10))))),
                                                                                                         MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_i))),
                                                                                                                               *,
                                                                                                                               List(IntConst(100))),
                                                                                                                    +,
                                                                                                                    List(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                               *,
                                                                                                                                               List(IntConst(10))),
                                                                                                                                    +,
                                                                                                                                    List(Var(_tile_j))))))),
                                                                                              List(Generator(VarPat(_tile_i),
                                                                                                             Range(IntConst(0),
                                                                                                                   MethodCall(Var(_size_i),
                                                                                                                              -,
                                                                                                                              List(IntConst(1))),
                                                                                                                   IntConst(1))),
                                                                                                   Generator(VarPat(_tile_j),
                                                                                                             Range(IntConst(0),
                                                                                                                   MethodCall(Var(_size_j),
                                                                                                                              -,
                                                                                                                              List(IntConst(1))),
                                                                                                                   IntConst(1))))))))))),
                                               MethodCall(Var(spark_context),
                                                          parallelize,
                                                          List(Comprehension(Tuple(List(Var(_coord_i),
                                                                                        Var(_coord_j),
                                                                                        IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                             +,
                                                                                                                             List(IntConst(1))),
                                                                                                                  *,
                                                                                                                  List(IntConst(10))),
                                                                                                       >,
                                                                                                       List(IntConst(100))),
                                                                                            MethodCall(IntConst(100),
                                                                                                       %,
                                                                                                       List(IntConst(10))),
                                                                                            IntConst(10)),
                                                                                        IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                             +,
                                                                                                                             List(IntConst(1))),
                                                                                                                  *,
                                                                                                                  List(IntConst(10))),
                                                                                                       >,
                                                                                                       List(IntConst(100))),
                                                                                            MethodCall(IntConst(100),
                                                                                                       %,
                                                                                                       List(IntConst(10))),
                                                                                            IntConst(10)))),
                                                                             List(Generator(VarPat(_coord_i),
                                                                                            Range(IntConst(0),
                                                                                                  MethodCall(IntConst(99),
                                                                                                             /,
                                                                                                             List(IntConst(10))),
                                                                                                  IntConst(1))),
                                                                                  Generator(VarPat(_coord_j),
                                                                                            Range(IntConst(0),
                                                                                                  MethodCall(IntConst(99),
                                                                                                             /,
                                                                                                             List(IntConst(10))),
                                                                                                  IntConst(1))))),
                                                               IntConst(10))))))))),
           VarDecl(N,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Tuple(List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List()),
                                       flatMap(Lambda(TuplePat(List(VarPat(_coord_i),
                                                                    VarPat(_coord_j),
                                                                    VarPat(_size_i),
                                                                    VarPat(_size_j))),
                                                      Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                     Var(_coord_j))),
                                                                          Store(tensor_2_0,
                                                                                List(BasicType(Int)),
                                                                                List(Tuple(List(Var(_size_i),
                                                                                                Var(_size_j))),
                                                                                     Tuple(List())),
                                                                                Comprehension(Tuple(List(Tuple(List(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_i))),
                                                                                                                               %,
                                                                                                                               List(IntConst(10))),
                                                                                                                    MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_j))),
                                                                                                                               %,
                                                                                                                               List(IntConst(10))))),
                                                                                                         MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                     *,
                                                                                                                                                     List(IntConst(10))),
                                                                                                                                          +,
                                                                                                                                          List(Var(_tile_i))),
                                                                                                                               *,
                                                                                                                               List(IntConst(100))),
                                                                                                                    +,
                                                                                                                    List(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                               *,
                                                                                                                                               List(IntConst(10))),
                                                                                                                                    +,
                                                                                                                                    List(Var(_tile_j))))))),
                                                                                              List(Generator(VarPat(_tile_i),
                                                                                                             Range(IntConst(0),
                                                                                                                   MethodCall(Var(_size_i),
                                                                                                                              -,
                                                                                                                              List(IntConst(1))),
                                                                                                                   IntConst(1))),
                                                                                                   Generator(VarPat(_tile_j),
                                                                                                             Range(IntConst(0),
                                                                                                                   MethodCall(Var(_size_j),
                                                                                                                              -,
                                                                                                                              List(IntConst(1))),
                                                                                                                   IntConst(1))))))))))),
                                               MethodCall(Var(spark_context),
                                                          parallelize,
                                                          List(Comprehension(Tuple(List(Var(_coord_i),
                                                                                        Var(_coord_j),
                                                                                        IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                             +,
                                                                                                                             List(IntConst(1))),
                                                                                                                  *,
                                                                                                                  List(IntConst(10))),
                                                                                                       >,
                                                                                                       List(IntConst(100))),
                                                                                            MethodCall(IntConst(100),
                                                                                                       %,
                                                                                                       List(IntConst(10))),
                                                                                            IntConst(10)),
                                                                                        IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                             +,
                                                                                                                             List(IntConst(1))),
                                                                                                                  *,
                                                                                                                  List(IntConst(10))),
                                                                                                       >,
                                                                                                       List(IntConst(100))),
                                                                                            MethodCall(IntConst(100),
                                                                                                       %,
                                                                                                       List(IntConst(10))),
                                                                                            IntConst(10)))),
                                                                             List(Generator(VarPat(_coord_i),
                                                                                            Range(IntConst(0),
                                                                                                  MethodCall(IntConst(99),
                                                                                                             /,
                                                                                                             List(IntConst(10))),
                                                                                                  IntConst(1))),
                                                                                  Generator(VarPat(_coord_j),
                                                                                            Range(IntConst(0),
                                                                                                  MethodCall(IntConst(99),
                                                                                                             /,
                                                                                                             List(IntConst(10))),
                                                                                                  IntConst(1))))),
                                                               IntConst(10))))))))),
           VarDecl(res,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Tuple(List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List()),
                                       flatMap(Lambda(TuplePat(List(VarPat(_v162),
                                                                    TuplePat(List(TuplePat(List(TuplePat(List(VarPat(_coord_i),
                                                                                                              VarPat(_coord_j))),
                                                                                                VarPat(_tile_a))),
                                                                                  TuplePat(List(TuplePat(List(VarPat(_coord_ii),
                                                                                                              VarPat(_coord_jj))),
                                                                                                VarPat(_tile_b))))))),
                                                      IfE(MethodCall(Var(_coord_ii),
                                                                     ==,
                                                                     List(Var(_coord_i))),
                                                          IfE(MethodCall(Var(_coord_jj),
                                                                         ==,
                                                                         List(Var(_coord_j))),
                                                              Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                             Var(_coord_j))),
                                                                                  Store(tensor_2_0,
                                                                                        List(BasicType(Int)),
                                                                                        List(Tuple(List(IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                             +,
                                                                                                                                             List(IntConst(1))),
                                                                                                                                  *,
                                                                                                                                  List(IntConst(10))),
                                                                                                                       >,
                                                                                                                       List(IntConst(100))),
                                                                                                            MethodCall(IntConst(100),
                                                                                                                       %,
                                                                                                                       List(IntConst(10))),
                                                                                                            IntConst(10)),
                                                                                                        IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                             +,
                                                                                                                                             List(IntConst(1))),
                                                                                                                                  *,
                                                                                                                                  List(IntConst(10))),
                                                                                                                       >,
                                                                                                                       List(IntConst(100))),
                                                                                                            MethodCall(IntConst(100),
                                                                                                                       %,
                                                                                                                       List(IntConst(10))),
                                                                                                            IntConst(10)))),
                                                                                             Tuple(List())),
                                                                                        Comprehension(Tuple(List(Tuple(List(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                             *,
                                                                                                                                                             List(IntConst(10))),
                                                                                                                                                  +,
                                                                                                                                                  List(Var(_tile_i))),
                                                                                                                                       %,
                                                                                                                                       List(IntConst(10))),
                                                                                                                            MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                             *,
                                                                                                                                                             List(IntConst(10))),
                                                                                                                                                  +,
                                                                                                                                                  List(Var(_tile_j))),
                                                                                                                                       %,
                                                                                                                                       List(IntConst(10))))),
                                                                                                                 MethodCall(Var(a),
                                                                                                                            +,
                                                                                                                            List(Var(b))))),
                                                                                                      List(Generator(TuplePat(List(TuplePat(List(VarPat(_tile_i),
                                                                                                                                                 VarPat(_tile_j))),
                                                                                                                                   VarPat(a))),
                                                                                                                     Lift(tensor_2_0,
                                                                                                                          Var(_tile_a))),
                                                                                                           Generator(TuplePat(List(TuplePat(List(VarPat(_tile_ii),
                                                                                                                                                 VarPat(_tile_jj))),
                                                                                                                                   VarPat(b))),
                                                                                                                     Lift(tensor_2_0,
                                                                                                                          Var(_tile_b))),
                                                                                                           Predicate(MethodCall(MethodCall(MethodCall(Var(_coord_ii),
                                                                                                                                                      *,
                                                                                                                                                      List(IntConst(10))),
                                                                                                                                           +,
                                                                                                                                           List(Var(_tile_ii))),
                                                                                                                                ==,
                                                                                                                                List(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                           *,
                                                                                                                                                           List(IntConst(10))),
                                                                                                                                                +,
                                                                                                                                                List(Var(_tile_i)))))),
                                                                                                           Predicate(MethodCall(MethodCall(MethodCall(Var(_coord_jj),
                                                                                                                                                      *,
                                                                                                                                                      List(IntConst(10))),
                                                                                                                                           +,
                                                                                                                                           List(Var(_tile_jj))),
                                                                                                                                ==,
                                                                                                                                List(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                           *,
                                                                                                                                                           List(IntConst(10))),
                                                                                                                                                +,
                                                                                                                                                List(Var(_tile_j))))))))))))),
                                                              Seq(List())),
                                                          Seq(List()))),
                                               Call(diablo_join,
                                                    List(flatMap(Lambda(TuplePat(List(TuplePat(List(VarPat(_coord_i),
                                                                                                    VarPat(_coord_j))),
                                                                                      VarPat(_tile_a))),
                                                                        Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                                       Var(_coord_j))),
                                                                                            Tuple(List(Tuple(List(Var(_coord_i),
                                                                                                                  Var(_coord_j))),
                                                                                                       Var(_tile_a)))))))),
                                                                 Nth(Var(M),
                                                                     3)),
                                                         flatMap(Lambda(TuplePat(List(TuplePat(List(VarPat(_coord_ii),
                                                                                                    VarPat(_coord_jj))),
                                                                                      VarPat(_tile_b))),
                                                                        Seq(List(Tuple(List(Tuple(List(Var(_coord_ii),
                                                                                                       Var(_coord_jj))),
                                                                                            Tuple(List(Tuple(List(Var(_coord_ii),
                                                                                                                  Var(_coord_jj))),
                                                                                                       Var(_tile_b)))))))),
                                                                 Nth(Var(N),
                                                                     3)),
                                                         Call(array_size,
                                                              List(Nth(Var(M),
                                                                       1))),
                                                         Call(array_size,
                                                              List(Nth(Var(N),
                                                                       1))),
                                                         IntConst(10))))))))),
           Seq(List(Var(res)))))
Compiled comprehension:
Block(List(VarDecl(M,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Tuple(List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List()),
                                       flatMap(Lambda(TuplePat(List(VarPat(_coord_i),
                                                                    VarPat(_coord_j),
                                                                    VarPat(_size_i),
                                                                    VarPat(_size_j))),
                                                      Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                     Var(_coord_j))),
                                                                          Tuple(List(Tuple(List(Var(_size_i),
                                                                                                Var(_size_j))),
                                                                                     Tuple(List()),
                                                                                     Block(List(VarDecl(zero,
                                                                                                        BasicType(Int),
                                                                                                        Seq(List())),
                                                                                                VarDecl(buffer,
                                                                                                        ArrayType(1,
                                                                                                                  BasicType(Int)),
                                                                                                        Seq(List(Call(array_buffer_dense,
                                                                                                                      List(MethodCall(Var(_size_i),
                                                                                                                                      *,
                                                                                                                                      List(Var(_size_j))),
                                                                                                                           Var(zero)))))),
                                                                                                MethodCall(flatMap(Lambda(VarPat(_v171),
                                                                                                                          IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                          *,
                                                                                                                                                                          List(IntConst(10))),
                                                                                                                                                               +,
                                                                                                                                                               List(Var(_v171))),
                                                                                                                                                    %,
                                                                                                                                                    List(IntConst(10))),
                                                                                                                                         >=,
                                                                                                                                         List(IntConst(0))),
                                                                                                                              IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                              *,
                                                                                                                                                                              List(IntConst(10))),
                                                                                                                                                                   +,
                                                                                                                                                                   List(Var(_v171))),
                                                                                                                                                        %,
                                                                                                                                                        List(IntConst(10))),
                                                                                                                                             <,
                                                                                                                                             List(Var(_size_i))),
                                                                                                                                  flatMap(Lambda(VarPat(_v172),
                                                                                                                                                 IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                 *,
                                                                                                                                                                                                 List(IntConst(10))),
                                                                                                                                                                                      +,
                                                                                                                                                                                      List(Var(_v172))),
                                                                                                                                                                           %,
                                                                                                                                                                           List(IntConst(10))),
                                                                                                                                                                >=,
                                                                                                                                                                List(IntConst(0))),
                                                                                                                                                     IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                     *,
                                                                                                                                                                                                     List(IntConst(10))),
                                                                                                                                                                                          +,
                                                                                                                                                                                          List(Var(_v172))),
                                                                                                                                                                               %,
                                                                                                                                                                               List(IntConst(10))),
                                                                                                                                                                    <,
                                                                                                                                                                    List(Var(_size_j))),
                                                                                                                                                         Seq(List(Assign(Index(Var(buffer),
                                                                                                                                                                               List(MethodCall(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                                                                                           *,
                                                                                                                                                                                                                                           List(IntConst(10))),
                                                                                                                                                                                                                                +,
                                                                                                                                                                                                                                List(Var(_v171))),
                                                                                                                                                                                                                     %,
                                                                                                                                                                                                                     List(IntConst(10))),
                                                                                                                                                                                                          *,
                                                                                                                                                                                                          List(Var(_size_j))),
                                                                                                                                                                                               +,
                                                                                                                                                                                               List(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                                                     *,
                                                                                                                                                                                                                                     List(IntConst(10))),
                                                                                                                                                                                                                          +,
                                                                                                                                                                                                                          List(Var(_v172))),
                                                                                                                                                                                                               %,
                                                                                                                                                                                                               List(IntConst(10))))))),
                                                                                                                                                                         Seq(List(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                                                                              *,
                                                                                                                                                                                                                              List(IntConst(10))),
                                                                                                                                                                                                                   +,
                                                                                                                                                                                                                   List(Var(_v171))),
                                                                                                                                                                                                        *,
                                                                                                                                                                                                        List(IntConst(100))),
                                                                                                                                                                                             +,
                                                                                                                                                                                             List(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                                        *,
                                                                                                                                                                                                                        List(IntConst(10))),
                                                                                                                                                                                                             +,
                                                                                                                                                                                                             List(Var(_v172)))))))))),
                                                                                                                                                         Seq(List())),
                                                                                                                                                     Seq(List()))),
                                                                                                                                          Range(IntConst(0),
                                                                                                                                                MethodCall(Var(_size_j),
                                                                                                                                                           -,
                                                                                                                                                           List(IntConst(1))),
                                                                                                                                                IntConst(1))),
                                                                                                                                  Seq(List())),
                                                                                                                              Seq(List()))),
                                                                                                                   MethodCall(Range(IntConst(0),
                                                                                                                                    MethodCall(Var(_size_i),
                                                                                                                                               -,
                                                                                                                                               List(IntConst(1))),
                                                                                                                                    IntConst(1)),
                                                                                                                              par,
                                                                                                                              null)),
                                                                                                           toList,
                                                                                                           null),
                                                                                                Var(buffer)))))))))),
                                               MethodCall(Var(spark_context),
                                                          parallelize,
                                                          List(MethodCall(flatMap(Lambda(VarPat(_coord_i),
                                                                                         flatMap(Lambda(VarPat(_coord_j),
                                                                                                        Seq(List(Tuple(List(Var(_coord_i),
                                                                                                                            Var(_coord_j),
                                                                                                                            IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                 +,
                                                                                                                                                                 List(IntConst(1))),
                                                                                                                                                      *,
                                                                                                                                                      List(IntConst(10))),
                                                                                                                                           >,
                                                                                                                                           List(IntConst(100))),
                                                                                                                                MethodCall(IntConst(100),
                                                                                                                                           %,
                                                                                                                                           List(IntConst(10))),
                                                                                                                                IntConst(10)),
                                                                                                                            IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                 +,
                                                                                                                                                                 List(IntConst(1))),
                                                                                                                                                      *,
                                                                                                                                                      List(IntConst(10))),
                                                                                                                                           >,
                                                                                                                                           List(IntConst(100))),
                                                                                                                                MethodCall(IntConst(100),
                                                                                                                                           %,
                                                                                                                                           List(IntConst(10))),
                                                                                                                                IntConst(10))))))),
                                                                                                 Range(IntConst(0),
                                                                                                       MethodCall(IntConst(99),
                                                                                                                  /,
                                                                                                                  List(IntConst(10))),
                                                                                                       IntConst(1)))),
                                                                                  MethodCall(Range(IntConst(0),
                                                                                                   MethodCall(IntConst(99),
                                                                                                              /,
                                                                                                              List(IntConst(10))),
                                                                                                   IntConst(1)),
                                                                                             par,
                                                                                             null)),
                                                                          toList,
                                                                          null),
                                                               IntConst(10))))))))),
           VarDecl(N,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Tuple(List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List()),
                                       flatMap(Lambda(TuplePat(List(VarPat(_coord_i),
                                                                    VarPat(_coord_j),
                                                                    VarPat(_size_i),
                                                                    VarPat(_size_j))),
                                                      Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                     Var(_coord_j))),
                                                                          Tuple(List(Tuple(List(Var(_size_i),
                                                                                                Var(_size_j))),
                                                                                     Tuple(List()),
                                                                                     Block(List(VarDecl(zero,
                                                                                                        BasicType(Int),
                                                                                                        Seq(List())),
                                                                                                VarDecl(buffer,
                                                                                                        ArrayType(1,
                                                                                                                  BasicType(Int)),
                                                                                                        Seq(List(Call(array_buffer_dense,
                                                                                                                      List(MethodCall(Var(_size_i),
                                                                                                                                      *,
                                                                                                                                      List(Var(_size_j))),
                                                                                                                           Var(zero)))))),
                                                                                                MethodCall(flatMap(Lambda(VarPat(_v180),
                                                                                                                          IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                          *,
                                                                                                                                                                          List(IntConst(10))),
                                                                                                                                                               +,
                                                                                                                                                               List(Var(_v180))),
                                                                                                                                                    %,
                                                                                                                                                    List(IntConst(10))),
                                                                                                                                         >=,
                                                                                                                                         List(IntConst(0))),
                                                                                                                              IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                              *,
                                                                                                                                                                              List(IntConst(10))),
                                                                                                                                                                   +,
                                                                                                                                                                   List(Var(_v180))),
                                                                                                                                                        %,
                                                                                                                                                        List(IntConst(10))),
                                                                                                                                             <,
                                                                                                                                             List(Var(_size_i))),
                                                                                                                                  flatMap(Lambda(VarPat(_v181),
                                                                                                                                                 IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                 *,
                                                                                                                                                                                                 List(IntConst(10))),
                                                                                                                                                                                      +,
                                                                                                                                                                                      List(Var(_v181))),
                                                                                                                                                                           %,
                                                                                                                                                                           List(IntConst(10))),
                                                                                                                                                                >=,
                                                                                                                                                                List(IntConst(0))),
                                                                                                                                                     IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                     *,
                                                                                                                                                                                                     List(IntConst(10))),
                                                                                                                                                                                          +,
                                                                                                                                                                                          List(Var(_v181))),
                                                                                                                                                                               %,
                                                                                                                                                                               List(IntConst(10))),
                                                                                                                                                                    <,
                                                                                                                                                                    List(Var(_size_j))),
                                                                                                                                                         Seq(List(Assign(Index(Var(buffer),
                                                                                                                                                                               List(MethodCall(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                                                                                           *,
                                                                                                                                                                                                                                           List(IntConst(10))),
                                                                                                                                                                                                                                +,
                                                                                                                                                                                                                                List(Var(_v180))),
                                                                                                                                                                                                                     %,
                                                                                                                                                                                                                     List(IntConst(10))),
                                                                                                                                                                                                          *,
                                                                                                                                                                                                          List(Var(_size_j))),
                                                                                                                                                                                               +,
                                                                                                                                                                                               List(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                                                     *,
                                                                                                                                                                                                                                     List(IntConst(10))),
                                                                                                                                                                                                                          +,
                                                                                                                                                                                                                          List(Var(_v181))),
                                                                                                                                                                                                               %,
                                                                                                                                                                                                               List(IntConst(10))))))),
                                                                                                                                                                         Seq(List(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                                                                              *,
                                                                                                                                                                                                                              List(IntConst(10))),
                                                                                                                                                                                                                   +,
                                                                                                                                                                                                                   List(Var(_v180))),
                                                                                                                                                                                                        *,
                                                                                                                                                                                                        List(IntConst(100))),
                                                                                                                                                                                             +,
                                                                                                                                                                                             List(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                                        *,
                                                                                                                                                                                                                        List(IntConst(10))),
                                                                                                                                                                                                             +,
                                                                                                                                                                                                             List(Var(_v181)))))))))),
                                                                                                                                                         Seq(List())),
                                                                                                                                                     Seq(List()))),
                                                                                                                                          Range(IntConst(0),
                                                                                                                                                MethodCall(Var(_size_j),
                                                                                                                                                           -,
                                                                                                                                                           List(IntConst(1))),
                                                                                                                                                IntConst(1))),
                                                                                                                                  Seq(List())),
                                                                                                                              Seq(List()))),
                                                                                                                   MethodCall(Range(IntConst(0),
                                                                                                                                    MethodCall(Var(_size_i),
                                                                                                                                               -,
                                                                                                                                               List(IntConst(1))),
                                                                                                                                    IntConst(1)),
                                                                                                                              par,
                                                                                                                              null)),
                                                                                                           toList,
                                                                                                           null),
                                                                                                Var(buffer)))))))))),
                                               MethodCall(Var(spark_context),
                                                          parallelize,
                                                          List(MethodCall(flatMap(Lambda(VarPat(_coord_i),
                                                                                         flatMap(Lambda(VarPat(_coord_j),
                                                                                                        Seq(List(Tuple(List(Var(_coord_i),
                                                                                                                            Var(_coord_j),
                                                                                                                            IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                 +,
                                                                                                                                                                 List(IntConst(1))),
                                                                                                                                                      *,
                                                                                                                                                      List(IntConst(10))),
                                                                                                                                           >,
                                                                                                                                           List(IntConst(100))),
                                                                                                                                MethodCall(IntConst(100),
                                                                                                                                           %,
                                                                                                                                           List(IntConst(10))),
                                                                                                                                IntConst(10)),
                                                                                                                            IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                 +,
                                                                                                                                                                 List(IntConst(1))),
                                                                                                                                                      *,
                                                                                                                                                      List(IntConst(10))),
                                                                                                                                           >,
                                                                                                                                           List(IntConst(100))),
                                                                                                                                MethodCall(IntConst(100),
                                                                                                                                           %,
                                                                                                                                           List(IntConst(10))),
                                                                                                                                IntConst(10))))))),
                                                                                                 Range(IntConst(0),
                                                                                                       MethodCall(IntConst(99),
                                                                                                                  /,
                                                                                                                  List(IntConst(10))),
                                                                                                       IntConst(1)))),
                                                                                  MethodCall(Range(IntConst(0),
                                                                                                   MethodCall(IntConst(99),
                                                                                                              /,
                                                                                                              List(IntConst(10))),
                                                                                                   IntConst(1)),
                                                                                             par,
                                                                                             null)),
                                                                          toList,
                                                                          null),
                                                               IntConst(10))))))))),
           VarDecl(res,
                   StorageType(rdd_block_tensor_2_0,
                               List(BasicType(Int)),
                               List(Tuple(List(IntConst(100), IntConst(100))),
                                    Tuple(List()))),
                   Seq(List(Tuple(List(Tuple(List(IntConst(100),
                                                  IntConst(100))),
                                       Tuple(List()),
                                       flatMap(Lambda(TuplePat(List(VarPat(_v162),
                                                                    TuplePat(List(TuplePat(List(TuplePat(List(VarPat(_coord_i),
                                                                                                              VarPat(_coord_j))),
                                                                                                VarPat(_tile_a))),
                                                                                  TuplePat(List(TuplePat(List(VarPat(_coord_ii),
                                                                                                              VarPat(_coord_jj))),
                                                                                                VarPat(_tile_b))))))),
                                                      IfE(MethodCall(Var(_coord_ii),
                                                                     ==,
                                                                     List(Var(_coord_i))),
                                                          IfE(MethodCall(Var(_coord_jj),
                                                                         ==,
                                                                         List(Var(_coord_j))),
                                                              Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                             Var(_coord_j))),
                                                                                  Let(VarPat(_v186),
                                                                                      Tuple(List(IfE(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                      +,
                                                                                                                                      List(IntConst(1))),
                                                                                                                           *,
                                                                                                                           List(IntConst(10))),
                                                                                                                >,
                                                                                                                List(IntConst(100))),
                                                                                                     MethodCall(IntConst(100),
                                                                                                                %,
                                                                                                                List(IntConst(10))),
                                                                                                     IntConst(10)),
                                                                                                 IfE(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                      +,
                                                                                                                                      List(IntConst(1))),
                                                                                                                           *,
                                                                                                                           List(IntConst(10))),
                                                                                                                >,
                                                                                                                List(IntConst(100))),
                                                                                                     MethodCall(IntConst(100),
                                                                                                                %,
                                                                                                                List(IntConst(10))),
                                                                                                     IntConst(10)))),
                                                                                      Tuple(List(Var(_v186),
                                                                                                 Tuple(List()),
                                                                                                 Block(List(VarDecl(zero,
                                                                                                                    BasicType(Int),
                                                                                                                    Seq(List())),
                                                                                                            VarDecl(buffer,
                                                                                                                    ArrayType(1,
                                                                                                                              BasicType(Int)),
                                                                                                                    Seq(List(Call(array_buffer_dense,
                                                                                                                                  List(MethodCall(Nth(Var(_v186),
                                                                                                                                                      1),
                                                                                                                                                  *,
                                                                                                                                                  List(Nth(Var(_v186),
                                                                                                                                                           2))),
                                                                                                                                       Var(zero)))))),
                                                                                                            Let(TuplePat(List(VarPat(_v196),
                                                                                                                              VarPat(_v197),
                                                                                                                              VarPat(_v198))),
                                                                                                                Var(_tile_a),
                                                                                                                Let(TuplePat(List(VarPat(_v203),
                                                                                                                                  VarPat(_v204),
                                                                                                                                  VarPat(_v205))),
                                                                                                                    Var(_tile_b),
                                                                                                                    MethodCall(flatMap(Lambda(VarPat(_v209),
                                                                                                                                              Let(VarPat(_v211),
                                                                                                                                                  MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                                   *,
                                                                                                                                                                                   List(IntConst(10))),
                                                                                                                                                                        +,
                                                                                                                                                                        List(Var(_v209))),
                                                                                                                                                             -,
                                                                                                                                                             List(MethodCall(Var(_coord_ii),
                                                                                                                                                                             *,
                                                                                                                                                                             List(IntConst(10))))),
                                                                                                                                                  flatMap(Lambda(VarPat(_v210),
                                                                                                                                                                 IfE(Call(inRange,
                                                                                                                                                                          List(Var(_v211),
                                                                                                                                                                               IntConst(0),
                                                                                                                                                                               MethodCall(Nth(Var(_v203),
                                                                                                                                                                                              1),
                                                                                                                                                                                          -,
                                                                                                                                                                                          List(IntConst(1))),
                                                                                                                                                                               IntConst(1))),
                                                                                                                                                                     Let(VarPat(_v212),
                                                                                                                                                                         MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                          *,
                                                                                                                                                                                                          List(IntConst(10))),
                                                                                                                                                                                               +,
                                                                                                                                                                                               List(Var(_v210))),
                                                                                                                                                                                    -,
                                                                                                                                                                                    List(MethodCall(Var(_coord_jj),
                                                                                                                                                                                                    *,
                                                                                                                                                                                                    List(IntConst(10))))),
                                                                                                                                                                         IfE(Call(inRange,
                                                                                                                                                                                  List(Var(_v212),
                                                                                                                                                                                       IntConst(0),
                                                                                                                                                                                       MethodCall(Nth(Var(_v203),
                                                                                                                                                                                                      2),
                                                                                                                                                                                                  -,
                                                                                                                                                                                                  List(IntConst(1))),
                                                                                                                                                                                       IntConst(1))),
                                                                                                                                                                             IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                                                                             *,
                                                                                                                                                                                                                             List(IntConst(10))),
                                                                                                                                                                                                                  +,
                                                                                                                                                                                                                  List(Var(_v209))),
                                                                                                                                                                                                       %,
                                                                                                                                                                                                       List(IntConst(10))),
                                                                                                                                                                                            >=,
                                                                                                                                                                                            List(IntConst(0))),
                                                                                                                                                                                 IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                                                                                 *,
                                                                                                                                                                                                                                 List(IntConst(10))),
                                                                                                                                                                                                                      +,
                                                                                                                                                                                                                      List(Var(_v209))),
                                                                                                                                                                                                           %,
                                                                                                                                                                                                           List(IntConst(10))),
                                                                                                                                                                                                <,
                                                                                                                                                                                                List(Nth(Var(_v186),
                                                                                                                                                                                                         1))),
                                                                                                                                                                                     IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                                                     *,
                                                                                                                                                                                                                                     List(IntConst(10))),
                                                                                                                                                                                                                          +,
                                                                                                                                                                                                                          List(Var(_v210))),
                                                                                                                                                                                                               %,
                                                                                                                                                                                                               List(IntConst(10))),
                                                                                                                                                                                                    >=,
                                                                                                                                                                                                    List(IntConst(0))),
                                                                                                                                                                                         IfE(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                                                         *,
                                                                                                                                                                                                                                         List(IntConst(10))),
                                                                                                                                                                                                                              +,
                                                                                                                                                                                                                              List(Var(_v210))),
                                                                                                                                                                                                                   %,
                                                                                                                                                                                                                   List(IntConst(10))),
                                                                                                                                                                                                        <,
                                                                                                                                                                                                        List(Nth(Var(_v186),
                                                                                                                                                                                                                 2))),
                                                                                                                                                                                             Seq(List(Assign(Index(Var(buffer),
                                                                                                                                                                                                                   List(MethodCall(MethodCall(MethodCall(MethodCall(MethodCall(Var(_coord_i),
                                                                                                                                                                                                                                                                               *,
                                                                                                                                                                                                                                                                               List(IntConst(10))),
                                                                                                                                                                                                                                                                    +,
                                                                                                                                                                                                                                                                    List(Var(_v209))),
                                                                                                                                                                                                                                                         %,
                                                                                                                                                                                                                                                         List(IntConst(10))),
                                                                                                                                                                                                                                              *,
                                                                                                                                                                                                                                              List(Nth(Var(_v186),
                                                                                                                                                                                                                                                       2))),
                                                                                                                                                                                                                                   +,
                                                                                                                                                                                                                                   List(MethodCall(MethodCall(MethodCall(Var(_coord_j),
                                                                                                                                                                                                                                                                         *,
                                                                                                                                                                                                                                                                         List(IntConst(10))),
                                                                                                                                                                                                                                                              +,
                                                                                                                                                                                                                                                              List(Var(_v210))),
                                                                                                                                                                                                                                                   %,
                                                                                                                                                                                                                                                   List(IntConst(10))))))),
                                                                                                                                                                                                             Seq(List(MethodCall(Index(Var(_v198),
                                                                                                                                                                                                                                       List(MethodCall(MethodCall(Var(_v209),
                                                                                                                                                                                                                                                                  *,
                                                                                                                                                                                                                                                                  List(Nth(Var(_v196),
                                                                                                                                                                                                                                                                           2))),
                                                                                                                                                                                                                                                       +,
                                                                                                                                                                                                                                                       List(Var(_v210))))),
                                                                                                                                                                                                                                 +,
                                                                                                                                                                                                                                 List(Index(Var(_v205),
                                                                                                                                                                                                                                            List(MethodCall(MethodCall(Var(_v211),
                                                                                                                                                                                                                                                                       *,
                                                                                                                                                                                                                                                                       List(Nth(Var(_v203),
                                                                                                                                                                                                                                                                                2))),
                                                                                                                                                                                                                                                            +,
                                                                                                                                                                                                                                                            List(Var(_v212)))))))))))),
                                                                                                                                                                                             Seq(List())),
                                                                                                                                                                                         Seq(List())),
                                                                                                                                                                                     Seq(List())),
                                                                                                                                                                                 Seq(List())),
                                                                                                                                                                             Seq(List()))),
                                                                                                                                                                     Seq(List()))),
                                                                                                                                                          Range(IntConst(0),
                                                                                                                                                                MethodCall(Nth(Var(_v196),
                                                                                                                                                                               2),
                                                                                                                                                                           -,
                                                                                                                                                                           List(IntConst(1))),
                                                                                                                                                                IntConst(1))))),
                                                                                                                                       MethodCall(Range(IntConst(0),
                                                                                                                                                        MethodCall(Nth(Var(_v196),
                                                                                                                                                                       1),
                                                                                                                                                                   -,
                                                                                                                                                                   List(IntConst(1))),
                                                                                                                                                        IntConst(1)),
                                                                                                                                                  par,
                                                                                                                                                  null)),
                                                                                                                               toList,
                                                                                                                               null))),
                                                                                                            Var(buffer)))))))))),
                                                              Seq(List())),
                                                          Seq(List()))),
                                               Call(diablo_join,
                                                    List(flatMap(Lambda(TuplePat(List(TuplePat(List(VarPat(_coord_i),
                                                                                                    VarPat(_coord_j))),
                                                                                      VarPat(_tile_a))),
                                                                        Seq(List(Tuple(List(Tuple(List(Var(_coord_i),
                                                                                                       Var(_coord_j))),
                                                                                            Tuple(List(Tuple(List(Var(_coord_i),
                                                                                                                  Var(_coord_j))),
                                                                                                       Var(_tile_a)))))))),
                                                                 Nth(Var(M),
                                                                     3)),
                                                         flatMap(Lambda(TuplePat(List(TuplePat(List(VarPat(_coord_ii),
                                                                                                    VarPat(_coord_jj))),
                                                                                      VarPat(_tile_b))),
                                                                        Seq(List(Tuple(List(Tuple(List(Var(_coord_ii),
                                                                                                       Var(_coord_jj))),
                                                                                            Tuple(List(Tuple(List(Var(_coord_ii),
                                                                                                                  Var(_coord_jj))),
                                                                                                       Var(_tile_b)))))))),
                                                                 Nth(Var(N),
                                                                     3)),
                                                         Call(array_size,
                                                              List(Nth(Var(M),
                                                                       1))),
                                                         Call(array_size,
                                                              List(Nth(Var(N),
                                                                       1))),
                                                         IntConst(10))))))))),
           Seq(List(Var(res)))))
Scala code:
{
  var M: scala.Tuple3[scala.Tuple2[Int, Int], EmptyTuple, org.apache.spark.rdd.RDD[scala.Tuple2[scala.Tuple2[Int, Int], scala.Tuple3[scala.Tuple2[Int, Int], EmptyTuple, Array[Int]]]]] = scala.Tuple3(scala.Tuple2(100, 100), EmptyTuple(), spark_context.parallelize(0.to((99)./(10)).par.flatMap(((_x$macro$810: Int) => _x$macro$810 match {
  case (_coord_i @ _) => 0.to((99)./(10)).map(((_x$macro$812: Int) => (_x$macro$812 match {
    case (_coord_j @ _) => scala.Tuple4(_coord_i, _coord_j, if (_coord_i.+(1).*(10).>(100))
      (100).%(10)
    else
      10, if (_coord_j.+(1).*(10).>(100))
      (100).%(10)
    else
      10)
  })))
})).toList, 10).map(((_x$macro$816: scala.Tuple4[Int, Int, Int, Int]) => _x$macro$816 match {
    case scala.Tuple4((_coord_i @ _), (_coord_j @ _), (_size_i @ _), (_size_j @ _)) => scala.Tuple2(scala.Tuple2(_coord_i, _coord_j), scala.Tuple3(scala.Tuple2(_size_i, _size_j), EmptyTuple(), {
      var zero: Int = 0;
      var buffer: Array[Int] = array_buffer_dense(_size_i.*(_size_j), zero);
      0.until(_size_i).par.foreach(((_v171: Int) => if (_coord_i.*(10).+(_v171).%(10).>=(0))
        if (_coord_i.*(10).+(_v171).%(10).<(_size_i))
          {
            var _v172 = 0;
            while (_v172.<=(_size_j.-(1))) 
              {
                if (_coord_j.*(10).+(_v172).%(10).>=(0))
                  if (_coord_j.*(10).+(_v172).%(10).<(_size_j))
                    buffer.update(_coord_i.*(10).+(_v171).%(10).*(_size_j).+(_coord_j.*(10).+(_v172).%(10)), _coord_i.*(10).+(_v171).*(100).+(_coord_j.*(10).+(_v172)))
                  else
                    ()
                else
                  ();
                _v172.+=(1)
              }
            
          }
        else
          ()
      else
        ()));
      buffer
    }))
  })));
  var N: scala.Tuple3[scala.Tuple2[Int, Int], EmptyTuple, org.apache.spark.rdd.RDD[scala.Tuple2[scala.Tuple2[Int, Int], scala.Tuple3[scala.Tuple2[Int, Int], EmptyTuple, Array[Int]]]]] = scala.Tuple3(scala.Tuple2(100, 100), EmptyTuple(), spark_context.parallelize(0.to((99)./(10)).par.flatMap(((_x$macro$822: Int) => _x$macro$822 match {
  case (_coord_i @ _) => 0.to((99)./(10)).map(((_x$macro$825: Int) => (_x$macro$825 match {
    case (_coord_j @ _) => scala.Tuple4(_coord_i, _coord_j, if (_coord_i.+(1).*(10).>(100))
      (100).%(10)
    else
      10, if (_coord_j.+(1).*(10).>(100))
      (100).%(10)
    else
      10)
  })))
})).toList, 10).map(((_x$macro$832: scala.Tuple4[Int, Int, Int, Int]) => _x$macro$832 match {
    case scala.Tuple4((_coord_i @ _), (_coord_j @ _), (_size_i @ _), (_size_j @ _)) => scala.Tuple2(scala.Tuple2(_coord_i, _coord_j), scala.Tuple3(scala.Tuple2(_size_i, _size_j), EmptyTuple(), {
      var zero: Int = 0;
      var buffer: Array[Int] = array_buffer_dense(_size_i.*(_size_j), zero);
      0.until(_size_i).par.foreach(((_v180: Int) => if (_coord_i.*(10).+(_v180).%(10).>=(0))
        if (_coord_i.*(10).+(_v180).%(10).<(_size_i))
          {
            var _v181 = 0;
            while (_v181.<=(_size_j.-(1))) 
              {
                if (_coord_j.*(10).+(_v181).%(10).>=(0))
                  if (_coord_j.*(10).+(_v181).%(10).<(_size_j))
                    buffer.update(_coord_i.*(10).+(_v180).%(10).*(_size_j).+(_coord_j.*(10).+(_v181).%(10)), _coord_i.*(10).+(_v180).*(100).+(_coord_j.*(10).+(_v181)))
                  else
                    ()
                else
                  ();
                _v181.+=(1)
              }
            
          }
        else
          ()
      else
        ()));
      buffer
    }))
  })));
  var res: scala.Tuple3[scala.Tuple2[Int, Int], EmptyTuple, org.apache.spark.rdd.RDD[scala.Tuple2[scala.Tuple2[Int, Int], scala.Tuple3[scala.Tuple2[Int, Int], EmptyTuple, Array[Int]]]]] = scala.Tuple3(scala.Tuple2(100, 100), EmptyTuple(), diablo_join(M._3.mapPartitions(((x$3) => x$3.map({
  case scala.Tuple2(scala.Tuple2((_coord_i @ _), (_coord_j @ _)), (_tile_a @ _)) => scala.Tuple2(scala.Tuple2(_coord_i, _coord_j), scala.Tuple2(scala.Tuple2(_coord_i, _coord_j), _tile_a))
})), preservesPartitioning = true), N._3.mapPartitions(((x$4) => x$4.map({
  case scala.Tuple2(scala.Tuple2((_coord_ii @ _), (_coord_jj @ _)), (_tile_b @ _)) => scala.Tuple2(scala.Tuple2(_coord_ii, _coord_jj), scala.Tuple2(scala.Tuple2(_coord_ii, _coord_jj), _tile_b))
})), preservesPartitioning = true), array_size(M._1), array_size(N._1), 10).flatMap(((_x$macro$851: scala.Tuple2[scala.Tuple2[Int, Int], scala.Tuple2[scala.Tuple2[scala.Tuple2[Int, Int], scala.Tuple3[scala.Tuple2[Int, Int], edu.uta.diablo.EmptyTuple, Array[Int]]], scala.Tuple2[scala.Tuple2[Int, Int], scala.Tuple3[scala.Tuple2[Int, Int], edu.uta.diablo.EmptyTuple, Array[Int]]]]]) => _x$macro$851 match {
    case scala.Tuple2((_v162 @ _), scala.Tuple2(scala.Tuple2(scala.Tuple2((_coord_i @ _), (_coord_j @ _)), (_tile_a @ _)), scala.Tuple2(scala.Tuple2((_coord_ii @ _), (_coord_jj @ _)), (_tile_b @ _)))) => if (_coord_ii.==(_coord_i))
      if (_coord_jj.==(_coord_j))
        List(scala.Tuple2(scala.Tuple2(_coord_i, _coord_j), {
          val _v186 = scala.Tuple2(if (_coord_i.+(1).*(10).>(100))
            (100).%(10)
          else
            10, if (_coord_j.+(1).*(10).>(100))
            (100).%(10)
          else
            10);
          scala.Tuple3(_v186, EmptyTuple(), {
            var zero: Int = 0;
            var buffer: Array[Int] = array_buffer_dense(_v186._1.*(_v186._2), zero);
            {
              val _v196 = _tile_a._1;
              val _v197 = _tile_a._2;
              val _v198 = _tile_a._3;
              {
                val _v203 = _tile_b._1;
                val _v204 = _tile_b._2;
                val _v205 = _tile_b._3;
                0.until(_v196._1).par.foreach(((_v209: Int) => {
                  val _v211 = _coord_i.*(10).+(_v209).-(_coord_ii.*(10));
                  {
                    var _v210 = 0;
                    while (_v210.<=(_v196._2.-(1))) 
                      {
                        if (_v211.>=(0).&&(_v211.<=(_v203._1.-(1))))
                          {
                            val _v212 = _coord_j.*(10).+(_v210).-(_coord_jj.*(10));
                            if (_v212.>=(0).&&(_v212.<=(_v203._2.-(1))))
                              if (_coord_i.*(10).+(_v209).%(10).>=(0))
                                if (_coord_i.*(10).+(_v209).%(10).<(_v186._1))
                                  if (_coord_j.*(10).+(_v210).%(10).>=(0))
                                    if (_coord_j.*(10).+(_v210).%(10).<(_v186._2))
                                      buffer.update(_coord_i.*(10).+(_v209).%(10).*(_v186._2).+(_coord_j.*(10).+(_v210).%(10)), _v198(_v209.*(_v196._2).+(_v210)).+(_v205(_v211.*(_v203._2).+(_v212))))
                                    else
                                      ()
                                  else
                                    ()
                                else
                                  ()
                              else
                                ()
                            else
                              ()
                          }
                        else
                          ();
                        _v210.+=(1)
                      }
                    
                  }
                }))
              }
            };
            buffer
          })
        }))
      else
        Nil
    else
      Nil
  })));
  res
}
Spark plan:
Scala type: scala.Tuple3[scala.Tuple2[Int, Int], edu.uta.diablo.EmptyTuple, org.apache.spark.rdd.RDD[scala.Tuple2[scala.Tuple2[Int, Int], scala.Tuple3[scala.Tuple2[Int, Int], edu.uta.diablo.EmptyTuple, Array[Int]]]]]
